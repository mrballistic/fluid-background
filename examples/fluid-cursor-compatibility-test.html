<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FluidCursor Cross-Browser Compatibility Test</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: Arial, sans-serif;
            background: #f0f0f0;
        }
        
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 30px;
        }
        
        .compatibility-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .test-card {
            background: white;
            border-radius: 8px;
            padding: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .test-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #333;
        }
        
        .test-result {
            padding: 10px;
            border-radius: 4px;
            margin: 5px 0;
            font-weight: bold;
        }
        
        .pass { background: #d4edda; color: #155724; }
        .fail { background: #f8d7da; color: #721c24; }
        .warning { background: #fff3cd; color: #856404; }
        .info { background: #d1ecf1; color: #0c5460; }
        
        .demo-area {
            background: #000;
            height: 400px;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            margin: 20px 0;
        }
        
        .demo-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            text-align: center;
            z-index: 10;
            pointer-events: none;
        }
        
        .browser-info {
            background: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        
        .feature-list {
            list-style: none;
            padding: 0;
        }
        
        .feature-list li {
            padding: 5px 0;
            border-bottom: 1px solid #eee;
        }
        
        .feature-list li:last-child {
            border-bottom: none;
        }
        
        .status-icon {
            display: inline-block;
            width: 20px;
            text-align: center;
            margin-right: 10px;
        }
        
        .performance-meter {
            width: 100%;
            height: 20px;
            background: #eee;
            border-radius: 10px;
            overflow: hidden;
            margin: 10px 0;
        }
        
        .performance-bar {
            height: 100%;
            transition: width 0.3s ease;
        }
        
        .perf-excellent { background: #28a745; }
        .perf-good { background: #ffc107; }
        .perf-poor { background: #dc3545; }
    </style>
</head>
<body>
    <div class="test-container">
        <div class="header">
            <h1>FluidCursor Cross-Browser Compatibility Test</h1>
            <p>This page tests WebGL compatibility and FluidCursor component functionality across different browsers.</p>
        </div>

        <!-- Browser Information -->
        <div class="browser-info">
            <h2>Browser Information</h2>
            <div id="browserInfo">Loading browser information...</div>
        </div>

        <!-- Compatibility Tests -->
        <div class="compatibility-grid">
            <!-- WebGL Support -->
            <div class="test-card">
                <div class="test-title">WebGL Support</div>
                <div id="webglTests">Running tests...</div>
            </div>

            <!-- Extension Support -->
            <div class="test-card">
                <div class="test-title">WebGL Extensions</div>
                <div id="extensionTests">Running tests...</div>
            </div>

            <!-- Texture Format Support -->
            <div class="test-card">
                <div class="test-title">Texture Formats</div>
                <div id="textureTests">Running tests...</div>
            </div>

            <!-- Performance Test -->
            <div class="test-card">
                <div class="test-title">Performance Test</div>
                <div id="performanceTests">
                    <div>Frame Rate: <span id="fpsCounter">--</span> FPS</div>
                    <div class="performance-meter">
                        <div id="performanceBar" class="performance-bar" style="width: 0%"></div>
                    </div>
                    <div id="performanceStatus">Initializing...</div>
                </div>
            </div>
        </div>

        <!-- Demo Area -->
        <div class="demo-area" id="demoArea">
            <canvas id="testCanvas" width="800" height="400" style="width: 100%; height: 100%;"></canvas>
            <div class="demo-overlay">
                <h3>FluidCursor Test Demo</h3>
                <p>Move your mouse over this area to test the fluid effect</p>
                <p id="demoStatus">Initializing...</p>
            </div>
        </div>

        <!-- Recommendations -->
        <div class="test-card">
            <div class="test-title">Recommendations</div>
            <div id="recommendations">Analyzing compatibility...</div>
        </div>
    </div>

    <script>
        // Browser Detection and Information
        function getBrowserInfo() {
            const ua = navigator.userAgent;
            const browserInfo = {
                userAgent: ua,
                platform: navigator.platform,
                language: navigator.language,
                cookieEnabled: navigator.cookieEnabled,
                onLine: navigator.onLine
            };

            // Detect browser
            if (ua.includes('Chrome') && !ua.includes('Edg')) {
                browserInfo.browser = 'Chrome';
            } else if (ua.includes('Firefox')) {
                browserInfo.browser = 'Firefox';
            } else if (ua.includes('Safari') && !ua.includes('Chrome')) {
                browserInfo.browser = 'Safari';
            } else if (ua.includes('Edg')) {
                browserInfo.browser = 'Edge';
            } else {
                browserInfo.browser = 'Unknown';
            }

            return browserInfo;
        }

        // WebGL Compatibility Tests
        function testWebGLSupport() {
            const canvas = document.createElement('canvas');
            const tests = {};

            // Test WebGL 1.0
            const gl1 = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
            tests.webgl1 = !!gl1;

            // Test WebGL 2.0
            const gl2 = canvas.getContext('webgl2');
            tests.webgl2 = !!gl2;

            // Use the best available context for further tests
            const gl = gl2 || gl1;
            tests.context = gl;

            if (gl) {
                tests.vendor = gl.getParameter(gl.VENDOR);
                tests.renderer = gl.getParameter(gl.RENDERER);
                tests.version = gl.getParameter(gl.VERSION);
                tests.shadingLanguageVersion = gl.getParameter(gl.SHADING_LANGUAGE_VERSION);
                tests.maxTextureSize = gl.getParameter(gl.MAX_TEXTURE_SIZE);
                tests.maxViewportDims = gl.getParameter(gl.MAX_VIEWPORT_DIMS);
            }

            return tests;
        }

        // Extension Tests
        function testExtensions(gl) {
            if (!gl) return {};

            const extensions = {
                'OES_texture_float': gl.getExtension('OES_texture_float'),
                'OES_texture_half_float': gl.getExtension('OES_texture_half_float'),
                'OES_texture_float_linear': gl.getExtension('OES_texture_float_linear'),
                'OES_texture_half_float_linear': gl.getExtension('OES_texture_half_float_linear'),
                'WEBGL_color_buffer_float': gl.getExtension('WEBGL_color_buffer_float'),
                'EXT_color_buffer_float': gl.getExtension('EXT_color_buffer_float'),
                'WEBGL_depth_texture': gl.getExtension('WEBGL_depth_texture'),
                'OES_standard_derivatives': gl.getExtension('OES_standard_derivatives')
            };

            return extensions;
        }

        // Texture Format Tests
        function testTextureFormats(gl) {
            if (!gl) return {};

            const formats = {};
            
            // Test floating point texture support
            try {
                const texture = gl.createTexture();
                gl.bindTexture(gl.TEXTURE_2D, texture);
                
                // Test RGBA float
                try {
                    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 4, 4, 0, gl.RGBA, gl.FLOAT, null);
                    formats.rgbaFloat = true;
                } catch (e) {
                    formats.rgbaFloat = false;
                }

                // Test half float (if extension available)
                const halfFloatExt = gl.getExtension('OES_texture_half_float');
                if (halfFloatExt) {
                    try {
                        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, 4, 4, 0, gl.RGBA, halfFloatExt.HALF_FLOAT_OES, null);
                        formats.rgbaHalfFloat = true;
                    } catch (e) {
                        formats.rgbaHalfFloat = false;
                    }
                }

                gl.deleteTexture(texture);
            } catch (e) {
                formats.error = e.message;
            }

            return formats;
        }

        // Performance Test
        let frameCount = 0;
        let lastTime = Date.now();
        let fps = 0;

        function performanceTest() {
            frameCount++;
            const now = Date.now();
            
            if (now - lastTime >= 1000) {
                fps = Math.round((frameCount * 1000) / (now - lastTime));
                frameCount = 0;
                lastTime = now;
                
                document.getElementById('fpsCounter').textContent = fps;
                
                // Update performance bar
                const performanceBar = document.getElementById('performanceBar');
                const performanceStatus = document.getElementById('performanceStatus');
                
                let percentage = Math.min((fps / 60) * 100, 100);
                performanceBar.style.width = percentage + '%';
                
                if (fps >= 50) {
                    performanceBar.className = 'performance-bar perf-excellent';
                    performanceStatus.textContent = 'Excellent performance - suitable for high quality settings';
                } else if (fps >= 30) {
                    performanceBar.className = 'performance-bar perf-good';
                    performanceStatus.textContent = 'Good performance - suitable for medium quality settings';
                } else {
                    performanceBar.className = 'performance-bar perf-poor';
                    performanceStatus.textContent = 'Poor performance - recommend low quality settings';
                }
            }
            
            requestAnimationFrame(performanceTest);
        }

        // Simple fluid simulation for testing
        function initTestDemo() {
            const canvas = document.getElementById('testCanvas');
            const gl = canvas.getContext('webgl2') || canvas.getContext('webgl');
            
            if (!gl) {
                document.getElementById('demoStatus').textContent = 'WebGL not supported';
                return;
            }

            document.getElementById('demoStatus').textContent = 'WebGL initialized - move mouse to test';
            
            // Simple test animation
            let mouseX = 0, mouseY = 0;
            
            canvas.addEventListener('mousemove', (e) => {
                const rect = canvas.getBoundingClientRect();
                mouseX = (e.clientX - rect.left) / rect.width;
                mouseY = 1.0 - (e.clientY - rect.top) / rect.height;
            });
            
            function animate() {
                gl.viewport(0, 0, canvas.width, canvas.height);
                gl.clearColor(0.1, 0.1, 0.2, 1.0);
                gl.clear(gl.COLOR_BUFFER_BIT);
                
                // Simple color based on mouse position
                gl.clearColor(mouseX * 0.5, mouseY * 0.5, 0.5, 1.0);
                gl.clear(gl.COLOR_BUFFER_BIT);
                
                requestAnimationFrame(animate);
            }
            
            animate();
        }

        // Display Results
        function displayResults() {
            const browserInfo = getBrowserInfo();
            const webglTests = testWebGLSupport();
            const extensions = testExtensions(webglTests.context);
            const textureFormats = testTextureFormats(webglTests.context);

            // Browser Info
            document.getElementById('browserInfo').innerHTML = `
                <strong>Browser:</strong> ${browserInfo.browser}<br>
                <strong>Platform:</strong> ${browserInfo.platform}<br>
                <strong>User Agent:</strong> ${browserInfo.userAgent}<br>
                <strong>Language:</strong> ${browserInfo.language}
            `;

            // WebGL Tests
            let webglHtml = '';
            webglHtml += `<div class="test-result ${webglTests.webgl1 ? 'pass' : 'fail'}">WebGL 1.0: ${webglTests.webgl1 ? 'Supported' : 'Not Supported'}</div>`;
            webglHtml += `<div class="test-result ${webglTests.webgl2 ? 'pass' : 'warning'}">WebGL 2.0: ${webglTests.webgl2 ? 'Supported' : 'Not Supported'}</div>`;
            
            if (webglTests.context) {
                webglHtml += `<div class="test-result info">Vendor: ${webglTests.vendor}</div>`;
                webglHtml += `<div class="test-result info">Renderer: ${webglTests.renderer}</div>`;
                webglHtml += `<div class="test-result info">Version: ${webglTests.version}</div>`;
                webglHtml += `<div class="test-result info">Max Texture Size: ${webglTests.maxTextureSize}</div>`;
            }
            
            document.getElementById('webglTests').innerHTML = webglHtml;

            // Extension Tests
            let extHtml = '<ul class="feature-list">';
            for (const [name, supported] of Object.entries(extensions)) {
                const icon = supported ? '✅' : '❌';
                const status = supported ? 'Supported' : 'Not Supported';
                extHtml += `<li><span class="status-icon">${icon}</span>${name}: ${status}</li>`;
            }
            extHtml += '</ul>';
            document.getElementById('extensionTests').innerHTML = extHtml;

            // Texture Format Tests
            let textureHtml = '<ul class="feature-list">';
            for (const [name, supported] of Object.entries(textureFormats)) {
                if (name === 'error') continue;
                const icon = supported ? '✅' : '❌';
                const status = supported ? 'Supported' : 'Not Supported';
                textureHtml += `<li><span class="status-icon">${icon}</span>${name}: ${status}</li>`;
            }
            textureHtml += '</ul>';
            document.getElementById('textureTests').innerHTML = textureHtml;

            // Recommendations
            let recommendations = '<ul>';
            
            if (!webglTests.webgl1) {
                recommendations += '<li class="test-result fail">❌ WebGL not supported - FluidCursor will not work</li>';
            } else {
                recommendations += '<li class="test-result pass">✅ WebGL supported - FluidCursor compatible</li>';
                
                if (webglTests.webgl2) {
                    recommendations += '<li class="test-result pass">✅ WebGL 2.0 available - optimal performance expected</li>';
                } else {
                    recommendations += '<li class="test-result warning">⚠️ WebGL 1.0 only - some features may use fallbacks</li>';
                }
                
                if (extensions['OES_texture_float'] || extensions['OES_texture_half_float']) {
                    recommendations += '<li class="test-result pass">✅ Float textures supported - full quality available</li>';
                } else {
                    recommendations += '<li class="test-result warning">⚠️ Float textures not supported - reduced precision</li>';
                }
                
                if (extensions['OES_texture_float_linear'] || extensions['OES_texture_half_float_linear']) {
                    recommendations += '<li class="test-result pass">✅ Linear filtering supported - smooth interpolation</li>';
                } else {
                    recommendations += '<li class="test-result warning">⚠️ Linear filtering not supported - manual filtering will be used</li>';
                }
                
                // Performance recommendations based on browser
                if (browserInfo.browser === 'Chrome') {
                    recommendations += '<li class="test-result pass">✅ Chrome detected - excellent WebGL support expected</li>';
                } else if (browserInfo.browser === 'Firefox') {
                    recommendations += '<li class="test-result pass">✅ Firefox detected - good WebGL support expected</li>';
                } else if (browserInfo.browser === 'Safari') {
                    recommendations += '<li class="test-result warning">⚠️ Safari detected - may need performance adjustments</li>';
                } else if (browserInfo.browser === 'Edge') {
                    recommendations += '<li class="test-result pass">✅ Edge detected - good WebGL support expected</li>';
                }
            }
            
            recommendations += '</ul>';
            document.getElementById('recommendations').innerHTML = recommendations;
        }

        // Initialize tests
        window.addEventListener('load', () => {
            displayResults();
            initTestDemo();
            performanceTest();
        });
    </script>
</body>
</html>